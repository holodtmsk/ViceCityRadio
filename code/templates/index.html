<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Game Interface</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="profile">
            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∞–≤–∞—Ç–∞—Ä–µ -->
            <div class="avatar">{{ initials }}</div>
            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="name">{{ username }}</div>
            <!-- –í—Å—Ç–∞–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–Ω–æ–≤, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–æ–º -->
            <div class="balance">${{ balance }}</div>
            <div class="tickets">
                üéüÔ∏è {{ spins }}
            </div>
        </div>
        
        <div class="slot-game">
            <span class="slot-game-text">SLOT GAME</span>
            <img src="{{ url_for('static', filename='images/slot_machine.png') }}" alt="Slot Machine" class="icon">
            <button class="play-button">PLAY</button>
        </div>

        <div class="container">
            <button id="farming-button" class="start-button">Start Farming</button>
        </div>

        <div class="navigation-bar">
            <div class="nav-item">
                <img src="{{ url_for('static', filename='images/home_icon.png') }}" alt="Home" class="nav-icon">
                <span>Home</span>
            </div>
            <div class="nav-item">
                <img src="{{ url_for('static', filename='images/frens_icon.png') }}" alt="Frens" class="nav-icon">
                <span>Frens</span>
            </div>
            <div class="nav-item">
                <img src="{{ url_for('static', filename='images/wallet_icon.png') }}" alt="Wallet" class="nav-icon">
                <span>Wallet</span>
            </div>
    </div>
<script>

    document.addEventListener('DOMContentLoaded', function () {
        const farmingButton = document.getElementById('farming-button');
        let farmingInProgress = false;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–∞
        farmingButton.addEventListener('click', function () {
            if (farmingInProgress || farmingButton.classList.contains('collect')) {
                return; // –ï—Å–ª–∏ —Ñ–∞—Ä–º–∏–Ω–≥ —É–∂–µ –∏–¥–µ—Ç –∏–ª–∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
            }

            // –ó–∞–ø—É—Å–∫ –≤–∏–±—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É
            if (window.Telegram && Telegram.WebApp.HapticFeedback) {
                Telegram.WebApp.HapticFeedback.impactOccurred('light'); // –õ–µ–≥–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ —Ñ–∞—Ä–º–∏–Ω–≥–∞
            }

            // –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ "–§–∞—Ä–º–∏–Ω–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
            farmingInProgress = true;
            farmingButton.classList.add('farming');
            farmingButton.innerHTML = 'üéü Farming goods... <span class="countdown">5</span>';

            let timeLeft = 5;
            const countdownInterval = setInterval(() => {
                timeLeft--;
                farmingButton.querySelector('.countdown').textContent = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(countdownInterval); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
                    farmingInProgress = false; // –§–∞—Ä–º–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω

                    // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –∏ –µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                    farmingButton.classList.remove('farming');
                    farmingButton.classList.add('collect');
                    farmingButton.textContent = 'Collect reward';

                    // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ñ–∞—Ä–º–∏–Ω–≥–∞
                    if (window.Telegram && Telegram.WebApp.HapticFeedback) {
                        Telegram.WebApp.HapticFeedback.impactOccurred('medium'); // –°—Ä–µ–¥–Ω—è—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
                    }
                }
            }, 1000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã
        farmingButton.addEventListener('click', function () {
            if (!farmingButton.classList.contains('collect')) return; // –ï—Å–ª–∏ –Ω–µ–ª—å–∑—è —Å–æ–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

            // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å–±–æ—Ä–µ –Ω–∞–≥—Ä–∞–¥—ã
            if (window.Telegram && Telegram.WebApp.HapticFeedback) {
                Telegram.WebApp.HapticFeedback.impactOccurred('heavy'); // –°–∏–ª—å–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å–±–æ—Ä–µ –Ω–∞–≥—Ä–∞–¥—ã
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã
            fetch('/collect_reward', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username: 'kholodvlad' // –£–∫–∞–∂–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                }),
            }).then(response => response.json())
              .then(data => {
                  if (data.newBalance !== undefined && data.newSpins !== undefined) {
                      // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–Ω–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                      document.querySelector('.balance').textContent = `$${data.newBalance}`;
                      document.querySelector('.tickets').textContent = `üéüÔ∏è ${data.newSpins}`;
                  } else {
                      console.error('–î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã.');
                  }
              }).catch(error => {
                  console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä–∞–¥—ã:', error);
              });

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã
            farmingButton.classList.remove('collect');
            farmingButton.textContent = 'Start Farming';
        });
    });
</script>

           
    </div>
</body>
</html>
